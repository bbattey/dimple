language: cpp
sudo: false  # docker VM
cache:
  directories:
  - libdeps/tarballs
matrix:
  include:
  - os: linux
    addons:
      apt:
        sources:
          - ubuntu-toolchain-r-test
        packages:
          - g++-7
          - libusb-dev
          - freeglut3-dev
          - autoconf-archive
          - libsamplerate0-dev
          - libasound2-dev
          - libusb-1.0-0-dev
          - unzip
          - libasound2-dev
          - libxcursor-dev
          - libxrandr-dev
          - libxinerama-dev
    env: HOST="" MATRIX_EVAL="CC=gcc-7 && CXX=g++-7"
    compiler: gcc
  - os: osx
    osx_image: xcode8
    env: HOST="" MATRIX_EVAL="rm -fv /usr/local/include/c++ && brew install freeglut autoconf-archive gcc && CC=gcc-7 && CXX=g++-7"
    compiler: clang
before_install:
  - eval "${MATRIX_EVAL}"
script:  ./bootstrap.sh && ls libdeps && ls libdeps/chai3d-3.2.0/src && (./autogen.sh || cat config.log) && make
after_script:
- make check
- make distcheck
- make install
notifications:
  email:
    recipients:
      - radarsat1@gmail.com
    on_success: never
    on_failure: change
